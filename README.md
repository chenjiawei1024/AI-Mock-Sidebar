# API Mock Sidebar

一个强大的Chrome浏览器扩展，用于快速生成、编辑和管理API模拟数据，支持AI生成模拟数据。

## 功能特点

- 📝 **可视化编辑**：支持可视化编辑模拟数据，无需手动编写JSON
- 🔄 **双模式切换**：支持可视化编辑和原始JSON编辑两种模式
- 🤖 **AI生成模拟**：集成Gemini Nano模型，智能生成符合业务逻辑的模拟数据
- 💾 **本地存储**：所有模拟数据保存在浏览器本地，安全可靠
- 📤 **HAR导入**：支持导入HAR文件，批量生成模拟数据
- 🌐 **全局开关**：支持全局启用/禁用模拟功能
- 📊 **进度监控**：模型下载进度实时显示
- 🎨 **现代化UI**：简洁美观的现代化界面设计

## 安装方法

### 方法一：加载已解压的扩展程序

1. 下载或克隆本扩展项目到本地
2. 打开Chrome浏览器，进入扩展管理页面（`chrome://extensions/`）
3. 开启右上角的「开发者模式」开关
4. 点击「加载已解压的扩展程序」按钮
5. 选择扩展项目的根目录，点击「选择文件夹」
6. 扩展安装成功，会在浏览器右上角显示扩展图标

### 方法二：通过Chrome Web Store安装

（待发布到Chrome Web Store后可用）

## 使用指南

### 1. 新建模拟

1. 点击浏览器右上角的扩展图标，打开侧边栏
2. 在「新建模拟」表单中填写以下信息：
   - **URL**：输入API的URL路径，支持完整URL或仅路径格式（如 `/api/users` 或 `https://example.com/api/users?MT=GET`）
   - **请求方法**：从下拉菜单选择HTTP请求方法（GET、POST、PUT、DELETE、PATCH）
   - **响应结构**：输入包含注释的JSON响应结构，支持两种格式：
     ```json
     // 带@注释的结构
     {
       "@ResponseStatus": "/* xs:object, note:响应状态 */",
       "ResponseStatus": {
         "@ErrorModule": "/* xs:integer, note:错误模块 */",
         "ErrorModule": 0,
         "@ErrorCode": "/* xs:integer, note:错误代码 */",
         "ErrorCode": 0
       }
     }
     
     // 直接JSON结构
     {
       "ResponseStatus": {
         "ErrorModule": 0,
         "ErrorCode": 0
       }
     }
     ```

3. 点击「生成模拟」按钮，扩展会根据响应结构生成模拟数据

### 2. 编辑模拟数据

#### 2.1 可视化编辑

- **编辑字段值**：点击任意字段值即可编辑，支持字符串、数字、布尔值等类型
- **编辑字段名**：点击字段名即可编辑
- **添加新字段**：点击字段间的分隔线，在指定位置添加新字段
- **删除字段**：暂不支持直接删除字段，可将字段值清空

#### 2.2 原始JSON编辑

- 点击右上角的「切换到原始JSON」按钮，切换到原始JSON编辑模式
- 直接编辑JSON字符串，支持语法高亮
- 编辑完成后，点击「保存模拟」或切换回可视化编辑模式
- 两种编辑模式之间的数据会自动同步

### 3. 保存模拟

1. 编辑完成后，点击「保存模拟」按钮
2. 模拟数据会保存到扩展的本地存储中
3. 保存成功后，会显示成功提示，并返回新建模拟表单

### 4. 取消编辑

- 在编辑过程中，如果不想保存，可以点击「取消编辑」按钮
- 取消编辑后，会清除当前编辑内容，返回新建模拟表单

### 5. AI生成模拟数据

#### 5.1 模型下载

1. 首次使用AI功能时，扩展会检测模型状态
2. 当模型可下载时，顶部会显示下载提示
3. 点击「下载模型」按钮，开始下载Gemini Nano模型
4. 下载过程中会显示实时进度条
5. 下载完成后，AI模拟按钮会自动启用

#### 5.2 使用AI生成模拟

1. 填写好URL、请求方法和带注释的响应结构
2. 点击「AI 生成模拟」按钮
3. 扩展会使用Gemini Nano模型生成符合响应结构的模拟数据
4. 生成完成后，会进入模拟数据编辑界面

### 6. 已保存模拟管理

#### 6.1 查看和管理模拟

- 侧边栏下方显示所有已保存的模拟
- 每个模拟显示URL路径、请求方法和启用状态
- 可以点击模拟展开查看详细信息

#### 6.2 编辑已保存的模拟

1. 找到要编辑的模拟，点击「编辑」按钮
2. 进入编辑界面，修改模拟数据
3. 点击「保存模拟」按钮保存修改

#### 6.3 启用/禁用模拟

- 找到要操作的模拟，点击「启用」或「禁用」按钮
- 状态会实时更新，禁用的模拟不会拦截请求

#### 6.4 删除模拟

- 找到要删除的模拟，点击「删除」按钮
- 确认后，模拟会被删除

#### 6.5 全局模拟开关

- 在已保存模拟列表上方，有一个「全局模拟开关」
- 关闭开关后，所有模拟都会被禁用，不会拦截任何请求
- 开启开关后，所有启用的模拟会生效

#### 6.6 导入HAR文件

1. 点击已保存模拟列表上方的「导入HAR」图标
2. 选择HAR格式的文件
3. 扩展会从HAR文件中提取API请求，生成模拟数据
4. 导入成功后，会显示成功提示，并刷新模拟列表

#### 6.7 删除全部模拟

1. 点击已保存模拟列表上方的「删除全部」图标
2. 确认后，所有已保存的模拟会被删除
3. 删除成功后，会显示成功提示，并刷新模拟列表

## 最佳实践

### 1. 响应结构设计

- 为每个字段添加清晰的注释，便于AI生成更准确的数据
- 合理设计嵌套结构，避免过深的层级
- 对于数组类型，建议包含至少一个示例项

### 2. 模拟数据管理

- 定期清理不再使用的模拟
- 使用描述性的URL路径，便于识别
- 合理使用启用/禁用功能，控制模拟生效范围

### 3. AI生成优化

- 提供详细的注释，帮助AI理解业务场景
- 对于复杂结构，先生成简单结构，再逐步扩展
- 生成后可以手动调整不符合预期的数据

## 常见问题

### 1. 模拟不生效怎么办？

- 检查全局模拟开关是否开启
- 检查该模拟是否启用
- 检查URL路径是否匹配
- 检查请求方法是否正确
- 打开浏览器开发者工具，查看网络请求是否被拦截

### 2. AI生成功能不可用？

- 检查浏览器版本是否为Chrome 127或更高
- 检查是否已下载并安装Gemini Nano模型
- 检查浏览器设置是否允许使用LanguageModel API
- 刷新页面或重启浏览器重试

### 3. 如何修改已保存的模拟？

- 找到要修改的模拟，点击「编辑」按钮
- 在编辑界面修改模拟数据
- 点击「保存模拟」按钮保存修改

### 4. 如何删除多个模拟？

- 点击「删除全部」图标，一次性删除所有模拟

## 技术支持

- 检查浏览器控制台是否有错误信息
- 确保使用最新版本的Chrome浏览器
- 检查扩展是否为最新版本
- 查看扩展管理页面的错误日志

## 更新日志

### v1.0.0

- 初始版本发布
- 支持新建模拟、AI生成模拟、保存模拟等基本功能
- 支持可视化编辑和原始JSON编辑两种模式
- 实现了模型下载进度监控
- 支持HAR导入和批量删除
- 提供了完整的模拟管理功能

## 浏览器兼容性

- Chrome 138+（支持Gemini Nano）
- Chrome 126-（不支持AI功能，但可使用其他功能）

## 联系方式

如有问题或建议，欢迎通过以下方式联系：
- 创建Issue：在GitHub仓库提交Issue
- 发送邮件：[your-email@example.com]（替换为实际邮箱）

---

**注意**：本扩展仅用于开发和测试环境，请勿在生产环境中使用。